########################################################################################
#                                                                                      #
#     .d8888b.  888                    888                                        D    #
#    d88P  Y88b 888                    888                                        O    #
#    Y88b.      888                    888                                        C    #
#     "Y888b.   88888b.   8888b.   .d88888  .d88b.  888  888  888 .d8888b         K    #
#        "Y88b. 888 "88b     "88b d88" 888 d88""88b 888  888  888 88K             E    #
#          "888 888  888 .d888888 888  888 888  888 888  888  888 "Y8888b.        R 1  #
#    Y88b  d88P 888  888 888  888 Y88b 888 Y88..88P Y88b 888 d88P      X88        F .  #
#     "Y8888P"  888  888 "Y888888  "Y88888  "Y88P"   "Y8888888P"   88888P'        I 0  #
#                                                                                 L .  #
#              .d888             d8888 888    888                   888           E 0  #
#             d88P"             d88888 888    888                   888                #
#             888              d88P888 888    888                   888                #
#     .d88b.  888888          d88P 888 888888 888  8888b.  88888b.  888888  8888b.     #
#    d88""88b 888            d88P  888 888    888     "88b 888 "88b 888        "88b    #
#    888  888 888           d88P   888 888    888 .d888888 888  888 888    .d888888    #
#    Y88..88P 888          d8888888888 Y88b.  888 888  888 888  888 Y88b.  888  888    #
#     "Y88P"  888         d88P     888  "Y888 888 "Y888888 888  888  "Y888 "Y888888    #
#                                                                                      #
########################################################################################

# STAGE: BASE IMAGE NODEJS 16
FROM node:16

# STAGE: PREPARE ENVIRONMENT
WORKDIR /usr/src/app
COPY package*.json ./
RUN npm install

# STAGE: PREPARE CODE
COPY . .
RUN echo "1" | run.sh

# STAGE: ENTRYPOINT
# EXPECTING: VOLUME MOUNT AT /usr/src/app/data
WORKDIR /usr/src/app/deploy
EXPOSE 4000
CMD [ "ranvier" ]
